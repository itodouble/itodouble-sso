<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.itodouble.sso.mapper.sso.add.SsoMenuAddMapper">

    <select id="getUserRoleMenuList" resultMap="top.itodouble.sso.mapper.sso.SsoMenuMapper.BaseResultMap">
        select <include refid="top.itodouble.sso.mapper.sso.SsoMenuMapper.a_Base_Column_List"></include>
        from sso_menu a
        inner join sso_permission b on a.id = b.menu_id
        <where>
            <if test="roleIds!=null and userId != null and userId != ''">
                and
                (b.role_id in
                <foreach item="item" collection="roleIds" separator="," open="(" close=")" index="">
                    #{item}
                </foreach>
                or ( b.user_id = #{userId} and b.role_id is null )
                )
            </if>
            <if test="systemCode!=null and systemCode!=''">
                and a.system_code = #{systemCode}
            </if>
            and a.del_flag = 0
        </where>
        order by a.sort
    </select>
</mapper>